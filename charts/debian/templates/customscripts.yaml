---
apiVersion: v1
kind: ConfigMap
metadata:
  name: customscripts
  namespace: debian
data:
  install-packages.bash: |
    #!/bin/bash
    
    chmod 1777 /tmp

    apt -qq update
    apt -qq full-upgrade


    apt -y -qq install psmisc openssh-server

    sed -i 's/#Port 22/Port 2222/g' /etc/ssh/sshd_config

    {{- if .Values.packages }}
    apt install -y -qq {{- range .Values.packages }} {{ . }}{{- end }}  
    {{- end }}

    apt -qq -y purge systemd
    apt -qq -y autoremove
    apt -qq -y clean

